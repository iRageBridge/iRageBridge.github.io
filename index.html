<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Retrieve Task</title>
<link rel="shortcut icon" href="images/task.png" alt="tab Icon">
<link type="text/css" rel="stylesheet" href="css/bootstrap.css"/>
<body id="mainBody">
<br/><br/><br/><br/>
<a href="#addTask"><button class="btn btn-success" style="width: 1080px; height: 1080px;">Add Task</button></a>
<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>

<div class="navbar navbar-default navbar-fixed-top" style="width: 1080px; margin-left:auto; margin-right:auto; background-color:#FFC;">
	<div class="container" id="tableCenter">
  		<div class="navbar-header">
          	<a href="index.html" class="navbar-brand">Task Manager</a><br/><br/>
        </div>
    </div>
</div>


<a name="addTask"></a>
<br/><br/><br/><br/>.<br/><br/><br/><br/>
<div id="border" class="input-group" style="background-color:#FFC;">
	<span class="input-group-addon" id="basic-addon-1" style="background-color:#09F;"></span>
	<br/><br/>Enter Task Decription Here:<br/><input type="text" id="descInput" class="form-control" placeholder="Description" aria-describedby="basic-addon-1"><br/><br/>
	Enter Task Priority Here:<br/><input type="number" id="priorInput" value=1 class="form-control" placeholder="Priority" aria-describedby="basic-addon-1"><br/><br/>
	Enter Task Due Date Here:<br/><input type="date" id="dateInput" class="form-control" placeholder="Due Date" aria-describedby="basic-addon-1"><br/><br/>
    <br/><a href="#table"><button id="enter" class="btn btn-default" style="margin: 5px;">Add Task</button></a>
    <a href="index.html"><button id="clear" href="index.html" class="btn btn-default" style="margin: 5px;">Clear Schedule</button></a>
</div>

<script>
	window.onload = printTable;
 	var info=document.createElement("h3");
    info.innerHTML="Task Manager Shown Below:";
	var mainBody=document.getElementById("mainBody");
	var peopleTable=document.createElement("table");
	peopleTable.setAttribute("id", "tableDesign");
    peopleTable.setAttribute("class", "table");
	peopleTable.setAttribute("style", "background-color:#FFC;");
	var tableBody=document.createElement("tbody");
	var heading=document.createElement("tr");
	var id=document.createElement("th");
	id.setAttribute("id", "sortID");
	var desc=document.createElement("th");
	desc.setAttribute("id", "sortDescription");
	var prior=document.createElement("th");
	prior.setAttribute("id", "sortPriority");
	var due=document.createElement("th");
	due.setAttribute("id", "sortDate");
	var del=document.createElement("th");
	id.innerHTML="ID";
	desc.innerHTML="Description";
	prior.innerHTML="Priority";
	due.innerHTML="Due Date";
	del.innerHTML="Delete?";
	var mainBody=document.getElementById("mainBody");
	var tasks=[];
	var keyinput= "myTask";
		
	document.getElementById("enter").onclick= function(){	
        var randomNumber = (Math.random() * 10) + 1;
		randomNumber=Math.round(randomNumber);
        var task={
			id: randomNumber,
			description: document.getElementById("descInput").value,
			priority: document.getElementById("priorInput").value,
			dueDate: document.getElementById("dateInput").value.toString(),
        };
		tasks.push(task);  
		printTable();
        if(typeof(window.localStorage)!="undefined"){
            window.localStorage.setItem(keyinput,JSON.stringify(tasks));	
		}
	
		else{
			alert("window.localStorage, not defined");
		}
    }
   
	function clearTable(){
		peopleTable.innerHTML="";
    }
	
	document.getElementById("clear").onclick=function(){
		localStorage.clear();
		clearTable();
	}

	
    function printTable(){
		var myTasks = JSON.parse(localStorage.getItem("myTask"));
        clearTable();
		mainBody.appendChild(info);
        mainBody.appendChild(peopleTable);
        peopleTable.appendChild(tableBody);
        tableBody.appendChild(heading);
        heading.appendChild(id);
        heading.appendChild(desc);
        heading.appendChild(prior);
        heading.appendChild(due);
        heading.appendChild(del);
        for(var i = 0; i < tasks.length; i++){
            var newRow=document.createElement("tr"); 
			var taskID=document.createElement("td");
			taskID.innerHTML=tasks[i].id;
			newRow.appendChild(taskID);
				    
			var taskDescription=document.createElement("td");
			taskDescription.innerHTML=tasks[i].description;
			newRow.appendChild(taskDescription);
					
			var taskPriority=document.createElement("td");
			taskPriority.innerHTML=tasks[i].priority;
			newRow.appendChild(taskPriority);
				
			var taskDueDate=document.createElement("td");
			taskDueDate.innerHTML=tasks[i].dueDate;
			newRow.appendChild(taskDueDate);
					
			var deleteRowButton=document.createElement("button");
			deleteRowButton.setAttribute("id", "deleteButton");
			deleteRowButton.setAttribute("class", "btn btn-default");
			deleteRowButton.innerHTML="Delete";
				    
			var deleteRow=document.createElement("td");
			deleteRow.appendChild(deleteRowButton);
			newRow.appendChild(deleteRow);
			peopleTable.appendChild(newRow);						
			 
            deleteRowButton.onclick=function(){
				var j = this.parentNode.parentNode.rowIndex;
                peopleTable.deleteRow(j-1);
				tasks.splice(j-1,1);
				window.localStorage.setItem(keyinput,JSON.stringify(tasks));
                clearTable();
				printTable();
			}
    	}		
    }
	
    desc.onclick=function(){
        tasks.sort(function(a,b){
            var nameA=a.description.toLowerCase();
            var nameB=b.description.toLowerCase();
		
            if (nameA < nameB){
				return -1;
            }
			
            if (nameA > nameB){
                return 1;
            }
			
            else{
                return 0;
            }
        })
		
        clearTable();
        printTable();
    }
	
    id.onclick=function(){
        tasks.sort(sortAgeFunction)
		
        function sortAgeFunction(a,b){
            return a.id-b.id;
        }
		
        clearTable();
        printTable();
    }
	
    prior.onclick=function(){
        tasks.sort(sortPriorFunction)
		
        function sortPriorFunction(a,b){
			
            return a.priority-b.priority;
        }
		
        clearTable();
        printTable();
    }
		
    due.onclick=function(){
        tasks.sort(function(a,b){
            var nameA=a.description.toLowerCase();
            var nameB=b.description.toLowerCase();
		
            if (nameA < nameB){
				return -1;
            }
			
            if (nameA > nameB){
                return 1;
            }
			
            else{
                return 0;
            }
        })
		
        clearTable();
        printTable();
    }
	

</script>
<script src="js/jQuery.js"></script>
<script src="js/bootstrap.js"></script>
<a name="table"></a>
<br/><br/><br/><br/><br/<br/><br/><br/><br/><br/><br/<br/><br/><br/><br/><br/<br/><br/><br/><br/<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
</body>
</html>